{% extends "baseTemplate.html" %}

{% block title %} Compiler {% endblock %}

{% block pageContent %}

<!DOCTYPE html>
<html>
	<head>
		{{ codemirror.include_codemirror() }}
		<title>Aggie Compiler - Editor</title>

		<!-- Bootstrap-->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" >
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" ></script>

		<!-- Compiler main files-->
		<script src = "codemirror5-master/src/compiler.js"> </script>
		<link href = "codemirror5-master/lib/compiler.css"rel="stylesheet"/>

		<!-- Javascript -->
		<script type = "text/javascript" src = "/static/js/j-query.min.js"> </script>
		<script type = "text/javascript" src = "static/js/default.js"> </script>
		
		<!-- Languages -->
		<script src = "static/languages/python.js"> </script>
		<script src = "static/languages/clike.js"> </script>

		<!-- Addons -->
		<script src = "addon/css-hint.js"> </script>
		<script src = "addon/show-hint.js"> </script>
		<script rel = "stylesheet" href = "addon/show-hint.css"></script>

		<script src = "codemirror5-master//addon/closetag.js"> </script>
		<script src = "static/addon/closeBracket.js"> </script>
		<link href = "static/theme/dracula.css"rel="stylesheet"/>
		<link href = "static/theme/monokai.css"rel="stylesheet"/>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css">		
		
	
	
	</head>

	<body>
	
		<form method = "POST" action = "/compiler" id = "code-form">
			<textarea id = "editor" name = "data"> </textarea>
			<button type = "submit"> Compile </button>
		</form>

		<div id = "output"></div> 

			<!-- test if this works either inside of body or outside of the body html -->
			<script> 
				var editor = CodeMirror.fromTextArea(
					document.getElementById('editor'),
					{
						mode: "python",
						theme: "monokai",
						lineNumbers: true,
						autoCloseTags: true,
						autoCloseBrackets: true,
						tabSize: 4,
						indentUnit: 4
					});

				var form = document.getElementById('code-form');
				form.addEventListener('submit', function(e){
					e.preventDefault();
					var code = editor.getValue();
					fetch('/compiler', {
						method: 'POST',
						body: new FormData(form)
					})
					.then(response => reponse.json())
					.then(data => {
						document.getElementById('output').textContent = data.output;
					});
				});

			</script>
</body>	


</html>
			
{% endblock %}

				<!--
				<form method = "POST">
					{{ form.csrf_token }}
					{{ form.source_code }}

					<textarea type = "text" name = "editor" class = "form-control" id = "editor"> </textarea>
					<button type = "submit"> Run </button>
				</form>
			-->

				<!-- This is the compiler textarea
				<textarea type = "text" class = "form-control" id = "editor"> </textarea>
				-->

			<!--
			<div class = "col d-flex flex-column rounded bg-dark px-4">
				<div class = "h-50">
					<label for = "Input" class = "text-light mt-4 mb-2"> Input </label>
					<textarea type = "text" class = "form-control h-75" aria-label = "last name"> </textarea>
				</div>
				<div class = "h-50">
					<label for = "Output" class = "text-light mb-2"> Output </label>
					<textarea type = "text" class = "form-control h-75" aria-label = "last name"> </textarea>
				</div>
			</div>
		-->

			
	

		<!---
		<script>
			var editor = CodeMirror.fromTextArea(document.getElementById("editor"), {
				mode: "text/x-c++src", <!-- "text/x-java" "text/x-csrc" "text/x-python"
				theme: "dracula",
				lineNumbers: true,
				autoCloseTags: true,
				autoCloseBrackets: true,
				tabSize: 4

			});
			var width = window.innerWidth

			var input = document.getElementById("Input")
			var output = document.getElementById("Output")

			editor.setSize(0.7 * width, "500")

			var option = document.getElementById("inlineFormSelectPref")
			option.addEventListener("change", function(){
				if(option.value == "Java"){
					editor.setOption("mode", "text/x-java")
				}
				else if(option.value == "Python"){
					editor.setOption("mode", "text/x-python")
				}
				else {
					editor.setOption("mode", "text/x-c++src")
				}
			})

			
		</script>  - ->
		
		</html>



